# Reading List Magazine - データベーステストツール

このディレクトリには、リーディングリストマガジン拡張機能のデータベース機能をテストするためのツールが含まれています。

## database-test.js

このスクリプトは、IndexedDB (Dexie.js) を使用したデータベース機能の手動テストを行うためのものです。

### 使用方法

1. Chromeで拡張機能をデバッグモードでロードする
   - `chrome://extensions` を開く
   - 「デベロッパーモード」を有効にする
   - 「パッケージ化されていない拡張機能を読み込む」をクリックし、プロジェクトのルートディレクトリを選択

2. 拡張機能のバックグラウンドページを開く
   - 拡張機能の詳細で「バックグラウンドページを検証」をクリック
   - DevToolsのコンソールタブを開く

3. スクリプトをコンソールに貼り付けて実行
   - `database-test.js` の内容をコピーしてコンソールに貼り付ける
   - スクリプトが読み込まれると、使用可能なテスト関数の一覧が表示される

4. 各テスト関数を実行する
   - `testDatabase()` - 基本的なデータベース機能のテスト
   - `testDatabasePerformance(100)` - パフォーマンステスト（引数はエントリ数）
   - `testDatabaseMigration()` - マイグレーション機能のテスト

### テスト内容

#### 基本テスト (testDatabase)

次のデータベース操作をテストします：

- データベースへの接続
- データのクリアと挿入
- IDまたはURLによるエントリの取得
- 各種フィルタリング条件によるエントリの検索
- エントリの更新と属性の変更
- 統計情報の取得
- エントリの削除（単一と一括）

#### パフォーマンステスト (testDatabasePerformance)

指定した数のエントリを使用して、以下の操作のパフォーマンスを測定します：

- 大量データの一括挿入
- 全件取得の速度
- フィルタリングと検索の応答時間
- 統計情報の計算速度

このテストは、拡張機能が大量のデータを処理する際のパフォーマンスを評価するのに役立ちます。

#### マイグレーションテスト (testDatabaseMigration)

データベーススキーマの変更に対する互換性をテストします：

- 古いスキーマ形式のエントリの作成
- マイグレーション後のフィールド追加や変換の確認
- 各フィールドの適切な初期化の検証

### 注意事項

- テストは実際のデータベースに対して実行されます。テスト中は既存のデータが一時的に削除されますが、テスト終了時に復元されます。
- パフォーマンステストを大きなエントリ数（1000以上）で実行する場合は、ブラウザの応答性に影響を与える可能性があるため注意してください。
- 実際のChrome拡張機能の環境でテストを行うため、拡張機能のバックグラウンドページのコンソールでのみ正常に動作します。
